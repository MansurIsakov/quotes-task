@let quote = quoteInput();
@let rating = currentRating();
@let loading = isLoading();

<div class="w-full max-w-2xl mx-auto">
  <div
    class="bg-linear-to-br from-slate-900 via-slate-800 to-slate-900 rounded-2xl p-8 md:p-12 shadow-2xl border border-slate-700"
  >
    <blockquote class="mb-8">
      <p class="text-2xl md:text-4xl font-serif text-white leading-relaxed italic">
        "{{ quote.text }}"
      </p>
    </blockquote>

    <div class="mb-8 flex items-center justify-between">
      <p class="text-lg text-slate-300 font-medium">â€” {{ quote.author }}</p>
      @if (quote.source && quote.source !== 'local') {
        <span class="text-xs bg-slate-700 text-slate-200 px-3 py-1 rounded-full">
          {{ quote.source }}
        </span>
      }
    </div>

    <div class="mb-8 pb-8 border-b border-slate-700">
      <div class="flex items-center gap-2 mb-3 text-slate-400">
        <lucide-angular [img]="icons.Heart" />
        <span class="text-sm">Rate this quote</span>
      </div>
      <div class="flex gap-2">
        @for (_ of [].constructor(5); track i; let i = $index) {
          @let rate = i + 1;
          <button
            class="w-10 h-10 rounded-lg font-semibold transition-all cursor-pointer"
            type="button"
            [ngClass]="{
              'bg-amber-500 text-white scale-110': rating === rate,
              'bg-slate-700 text-slate-300 hover:bg-slate-600': rating !== rate,
            }"
            (click)="rateQuote.emit(rate)"
          >
            {{ rate }}
          </button>
        }
      </div>
    </div>

    <div class="flex flex-col sm:flex-row gap-3">
      <button
        class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 rounded-lg transition-all cursor-pointer"
        type="button"
        [disabled]="loading"
        (click)="nextQuote.emit()"
      >
        @if (!loading) {
          <span>Next Quote</span>
        } @else {
          <span class="flex items-center justify-center">
            <lucide-angular class="w-4 h-4 mr-2 animate-spin" [img]="icons.LucideLoader" />
            Loading...
          </span>
        }
      </button>

      <button
        class="flex-1 flex items-center justify-center gap-2 border border-slate-600 text-slate-300 hover:bg-slate-700 rounded-lg py-2 cursor-pointer"
        type="button"
        (click)="shareQuote.emit('twitter')"
      >
        <lucide-angular class="w-4 h-4" [img]="icons.Twitter" />
        Twitter
      </button>
      <button
        class="flex-1 flex items-center justify-center gap-2 border border-slate-600 text-slate-300 hover:bg-slate-700 rounded-lg py-2 cursor-pointer"
        type="button"
        (click)="shareQuote.emit('facebook')"
      >
        <lucide-angular class="w-4 h-4" [img]="icons.Facebook" />
        Facebook
      </button>
    </div>
  </div>
</div>
